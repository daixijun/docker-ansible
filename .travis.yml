language: bash

env:
  global:
    - DOCKER_IMAGE=daixijun1990/ansible MITOGEN_VERSION=0.2.6
  matrix:
    - ANSIBLE_VERSION=2.5.15
    - ANSIBLE_VERSION=2.6.15
    - ANSIBLE_VERSION=2.7.9

services:
  - docker

before_script:
  - docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD"

script:
  - docker build --build-arg ansible_version=$ANSIBLE_VERSION --build-arg mitogen_version=$MITOGEN_VERSION --tag $DOCKER_IMAGE:v$ANSIBLE_VERSION .
  - docker push $DOCKER_IMAGE:v$ANSIBLE_VERSION
